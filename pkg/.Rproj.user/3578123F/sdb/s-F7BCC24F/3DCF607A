{
    "collab_server" : "",
    "contents" : "\n\n###################\n## beeswarm.plot ##\n###################\n\n########################################################################\n\n###################\n## DOCUMENTATION ##\n###################\n\n#' Beeswarm-and-Box-Plot.\n#'\n#' Wrapper combining the beeswarm and box plot functions from packages \\code{beeswarm} and \\code{ggplot2}.\n#'\n#' @param y A character string specifying the label of the (numeric) column\n#' in data frame \\code{df} to be plotted along the y-axis.\n#'\n#'\n#' @author Caitlin Collins \\email{caitiecollins@@gmail.com}\n#' @examples\n#'\n#' ## load data\n#' data(dist)\n#' str(dist)\n#'\n#' ## basic use of fn\n#' fn(arg1, arg2)\n#'\n#' #' ## more elaborate use of fn\n#' fn(arg1, arg2)\n#'\n#' @import ggplot2\n#' @importFrom beeswarm beeswarm\n#'\n#' @export\n\n########################################################################\n\n###################\n## beeswarm.plot ##\n###################\n\nbeeswarm.plot <- function(y=\"sensitivity\", x=\"test\", df, y.lab=NULL,\n                          pt.size=4, x.text=FALSE){\n\n  require(beeswarm)\n  require(Hmisc)\n  # library(plyr)\n  # library(ggplot2)\n\n  if(is.null(y.lab)) y.lab <- y\n\n  ## Y ~ X ??\n  fm <- as.formula(paste(y, x, sep=\" ~ \"))\n\n  beeswarm.ori <- beeswarm::beeswarm(fm,\n                                     data = df,\n                                     #method=\"swarm\", # swarm square hex center\n                                     #priority=\"descending\", ## ONLY for SWARM method...\n                                     method=\"center\", # swarm square hex center\n                                     #priority=\"descending\", ## ONLY for SWARM method...\n                                     pwcol = eval(parse(text=x)),\n                                     #col = myCol, ## to set w funky colours (INSTEAD of pwcol = test)\n                                     ylim = c(-0.001,1), # otherwise ggplot can't plot ZERO values --> NAs\n                                     las=2,\n                                     cex=0.8,\n                                     corral = \"omit\",\n                                     do.plot = FALSE) # none gutter wrap omit\n  # head(beeswarm)\n\n  ######################################################\n  ## Find and Replace OUTLIERS(' symbols in plot...): ##\n  ######################################################\n  outliers <- outlier.vals <- PCH <- list()\n\n  if(!is.factor(df[,x])) df[,x] <- as.factor(df[,x])\n  if(!all(as.character(beeswarm.ori$col) %in% levels(df[,x]))){\n    foo <- beeswarm.ori$col\n    foo <- levels(df[,x])[foo]\n    beeswarm.ori$col <- factor(foo, levels=levels(df[,x]))\n  }else{\n    beeswarm.ori$col <- factor(beeswarm.ori$col)\n  }\n\n  noms <- as.character(levels(beeswarm.ori$col))\n\n  ## FOR LOOP ##\n  for(i in 1:length(noms)){\n    #i <- 1\n    # get vals for variable (and boxplot)\n    val <- beeswarm.ori$y[which(beeswarm.ori$col==noms[i])]\n    #boxplot(val, ylim=c(-0.001, 1))\n    if(length(val) == 0){\n      PCH[[i]] <- NULL\n      outliers[[i]] <- NULL\n    }else{\n      PCH[[i]] <- rep(16, length(val)) # standard filled circle...\n\n      ## get median\n      M <- as.numeric(quantile(val, 0.5))\n      # get lower 25 of box\n      Q25 <- as.numeric(quantile(val, 0.25))\n      # get upper 75 of box\n      Q75 <- as.numeric(quantile(val, 0.75))\n      # get box length\n      box <- Q75-Q25\n\n      if(box == 0) box <- 0.0000001\n\n      # with a coef of 1.5 (the default for boxplots), identify outlying values\n      outliers[[i]] <- c(which(val < Q25-(1.5*box)), which(val > Q75+(1.5*box)))\n      # get values of outliers\n      if(length(outliers[[i]]) > 0){\n        outlier.vals[[i]] <- val[outliers[[i]]]\n        PCH[[i]] <- replace(PCH[[i]], outliers[[i]], 17) # replace with triangle...\n      }else{\n        outlier.vals[[i]] <- NULL\n      }\n    }\n  } # end for loop\n\n  #outliers\n  PCH <- as.vector(unlist(PCH))\n  # PCH\n\n\n  #########################################################################################################\n  ######################\n  ## plots, layers... ##\n  ######################\n\n  if(x.text == FALSE){\n\n    ################\n    ## NO X-TEXT: ##\n    ################\n\n    beeswarm.plot1 <- ggplot(beeswarm.ori, aes(x, y)) +\n      xlab(\"\") +\n      guides(fill=FALSE) +\n      scale_x_discrete(drop=FALSE) +\n      scale_y_continuous(y.lab, limits=c(0,1))  # expression(\"char\")\n\n    beeswarm.plot2 <- beeswarm.plot1 +\n      guides(fill=FALSE) +\n      geom_boxplot(data=df, aes(x=eval(parse(text=x)), y=eval(parse(text=y)), fill=eval(parse(text=x))), alpha=0.25,\n                   outlier.shape = 17,\n                   outlier.size=0) +\n      theme(axis.text.x=element_blank(),\n            axis.ticks.x=element_blank(), axis.title.x=element_blank(),\n            axis.text.y = element_text(size=13),\n            # axis.title.y=element_text(size=18),\n            axis.title.y=element_blank(),\n            legend.position=\"none\")\n\n    beeswarm.plot3 <- beeswarm.plot2 +\n      geom_point(data=beeswarm.ori, aes(colour = col), pch = PCH, size=pt.size, na.rm=TRUE, alpha=0.6) +\n      guides(fill=FALSE) +\n      theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(), axis.title.x=element_blank(),\n            axis.text.y = element_text(size=13),\n            # axis.title.y=element_text(size=18),\n            axis.title.y=element_blank(),\n            legend.position=\"none\")\n\n    beeswarm.plot4 <- beeswarm.plot3 +\n      guides(fill=FALSE) +\n      geom_boxplot(data=df, aes(x=eval(parse(text=x)), y=eval(parse(text=y)), fill=eval(parse(text=x))), alpha=0.0, fatten=3,\n                   outlier.shape = 17,\n                   outlier.size=0) +\n      theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(), axis.title.x=element_blank(),\n            axis.text.y = element_text(size=13),\n            # axis.title.y=element_text(size=18),\n            axis.title.y=element_blank(),\n            legend.position=\"none\")\n  }else{\n\n    ##################\n    ## WITH X-TEXT: ##\n    ##################\n\n    #############################\n    ## NUMERIC x-axis labels?? ##\n    #############################\n    if(all.is.numeric(levels(df[, x]))){\n      beeswarm.plot1 <- ggplot(beeswarm.ori, aes(x, y)) +\n        xlab(\"\") +\n        guides(fill=FALSE) +\n        scale_x_discrete(drop=FALSE) +\n        scale_y_continuous(y.lab, limits=c(0,1)) # expression(\"char\")\n\n      beeswarm.plot2 <- beeswarm.plot1 +\n        guides(fill=FALSE) +\n        geom_boxplot(data=df, aes(x=eval(parse(text=x)), y=eval(parse(text=y)), fill=eval(parse(text=x))), alpha=0.25,\n                     outlier.shape = 17,\n                     outlier.size=0) +\n        theme(axis.text.x = element_text(size=13),\n              # axis.text.x = element_text(angle=35, hjust=1, vjust=0.95, size=10),\n              axis.text.y = element_text(size=13),\n              axis.title.y = element_text(size=18),\n              axis.title.x = element_blank(),\n              legend.position=\"none\")\n\n      beeswarm.plot3 <- beeswarm.plot2 +\n        geom_point(data=beeswarm.ori, aes(colour = col), pch = PCH, size=pt.size, na.rm=TRUE, alpha=0.6) +\n        guides(fill=FALSE) +\n        theme(axis.text.x = element_text(size=13),\n              # axis.text.x = element_text(angle=35, hjust=1, vjust=0.95, size=10),\n              axis.text.y = element_text(size=13),\n              axis.title.y = element_text(size=18),\n              axis.title.x = element_blank(),\n              legend.position=\"none\")\n\n      beeswarm.plot4 <- beeswarm.plot3 +\n        guides(fill=FALSE) +\n        geom_boxplot(data=df, aes(x=eval(parse(text=x)), y=eval(parse(text=y)), fill=eval(parse(text=x))), alpha=0.0, fatten=3,\n                     outlier.shape = 17,\n                     outlier.size=0) +\n        theme(axis.text.x = element_text(size=13),\n              # axis.text.x = element_text(angle=35, hjust=1, vjust=0.95, size=10),\n              axis.text.y = element_text(size=13),\n              axis.title.y = element_text(size=18),\n              axis.title.x = element_blank(),\n              legend.position=\"none\")\n    }else{\n\n      ######################################\n      ## CHARACTER STRING x-axis labels?? ##\n      ######################################\n      beeswarm.plot1 <- ggplot(beeswarm.ori, aes(x, y)) +\n        xlab(\"\") +\n        guides(fill=FALSE) +\n        scale_x_discrete(drop=FALSE) +\n        scale_y_continuous(y.lab, limits=c(0,1)) # expression(\"char\")\n\n      beeswarm.plot2 <- beeswarm.plot1 +\n        guides(fill=FALSE) +\n        geom_boxplot(data=df, aes(x=eval(parse(text=x)), y=eval(parse(text=y)), fill=eval(parse(text=x))), alpha=0.25,\n                     outlier.shape = 17,\n                     outlier.size=0) +\n        theme(axis.text.x = element_text(angle=35, hjust=1, vjust=0.95, size=10),\n              # axis.text.x = element_text(size=13),\n              axis.text.y = element_text(size=13),\n              axis.title.y = element_text(size=18),\n              axis.title.x = element_blank(),\n              legend.position=\"none\")\n\n      beeswarm.plot3 <- beeswarm.plot2 +\n        geom_point(data=beeswarm.ori, aes(colour = col), pch = PCH, size=pt.size, na.rm=TRUE, alpha=0.6) +\n        guides(fill=FALSE) +\n        theme(axis.text.x = element_text(angle=35, hjust=1, vjust=0.95, size=10),\n              # axis.text.x = element_text(size=13),\n              axis.text.y = element_text(size=13),\n              axis.title.y = element_text(size=18),\n              axis.title.x = element_blank(),\n              legend.position=\"none\")\n\n      beeswarm.plot4 <- beeswarm.plot3 +\n        guides(fill=FALSE) +\n        geom_boxplot(data=df, aes(x=eval(parse(text=x)), y=eval(parse(text=y)), fill=eval(parse(text=x))), alpha=0.0, fatten=3,\n                     outlier.shape = 17,\n                     outlier.size=0) +\n        theme(axis.text.x = element_text(angle=35, hjust=1, vjust=0.95, size=10),\n              # axis.text.x = element_text(size=13),\n              axis.text.y = element_text(size=13),\n              axis.title.y = element_text(size=18),\n              axis.title.x = element_blank(),\n              legend.position=\"none\")\n    }\n  }\n\n\n  ## PRINT PLOT ##\n  plot(beeswarm.plot4)\n\n} # end beeswarm.plot\n",
    "created" : 1474609798321.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1714017316",
    "id" : "3DCF607A",
    "lastKnownWriteTime" : 1474612843,
    "last_content_update" : 1474612843937,
    "path" : "D:/treeWAS/pkg/R/beeswarm.plot.R",
    "project_path" : "R/beeswarm.plot.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}